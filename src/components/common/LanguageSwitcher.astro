---
import { getLangFromUrl, stripLangFromPath, defaultLang } from '~/i18n';

export interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;

const currentLang = getLangFromUrl(Astro.url);
const currentPath = stripLangFromPath(Astro.url.pathname);

// Determine switch target: if on English, go to Chinese; if on Chinese, go to English
const isEnglish = currentLang === defaultLang;
const switchLink = isEnglish ? `/cn${currentPath}` : currentPath;
const switchText = isEnglish ? 'CN' : 'EN';
---

<a
  href={switchLink}
  class:list={[
    'lang-switch',
    className,
  ]}
  aria-label={isEnglish ? 'Switch to Chinese' : 'Switch to English'}
>
  {switchText}
</a>

<style>
  .lang-switch {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--aw-color-text-default);
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
  }

  .lang-switch:hover {
    color: var(--aw-color-primary);
    background-color: rgba(43, 116, 255, 0.08);
  }

  :global(.dark) .lang-switch {
    color: rgba(255, 255, 255, 0.9);
  }

  :global(.dark) .lang-switch:hover {
    color: rgb(139, 210, 255);
    background-color: rgba(77, 142, 255, 0.15);
  }
</style>
